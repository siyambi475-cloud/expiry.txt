import os
import requests
import datetime

# ржЖржкржирж╛рж░ GitHub Raw рж▓рж┐ржЩрзНржХржЧрзБрж▓рзЛ (рж╕ржарж┐ржХржнрж╛ржмрзЗ ржмрж╕рж╛ржмрзЗржи)
EXPIRY_URL = "https://raw.githubusercontent.com/siyambi475-cloud/expiry.txt/main/expiry.txt"
COMMAND_URL = "https://raw.githubusercontent.com/siyambi475-cloud/expiry.txt/main/cmd.txt"

# ржЖржкржирж╛рж░ ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржХржирзНржЯрж╛ржХрзНржЯ рж▓рж┐ржЩрзНржХ ржмрж╛ ржЗржЙржЬрж╛рж░ржирзЗржо
TELEGRAM_ADMIN = "@your_username" # ржПржЦрж╛ржирзЗ ржЖржкржирж╛рж░ ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржЗржЙржЬрж╛рж░ржирзЗржо ржжрж┐ржи

def get_data(url):
    try:
        r = requests.get(url, timeout=10)
        return r.text.strip() if r.status_code == 200 else None
    except:
        return None

def start():
    print("тП│ ржЪрзЗржХрж┐ржВ ржПржХрзНрж╕рзЗрж╕...")
    
    # рзз. ржорзЗрзЯрж╛ржж ржЪрзЗржХ ржХрж░рж╛
    expiry_date_str = get_data(EXPIRY_URL)
    if not expiry_date_str:
        print("тЭМ ржЗржирзНржЯрж╛рж░ржирзЗржЯ ржирзЗржЗ ржмрж╛ рж╕рж╛рж░рзНржнрж╛рж░ рж╕ржорж╕рзНржпрж╛! ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржиред")
        return

    try:
        expiry_date = datetime.datetime.strptime(expiry_date_str, '%Y-%m-%d').date()
    except:
        print("тЭМ рждрж╛рж░рж┐ржЦрзЗрж░ ржлрж░ржорзНржпрж╛ржЯ ржнрзБрж▓! ржЕрзНржпрж╛ржбржорж┐ржирзЗрж░ рж╕рж╛рж╣рж╛ржпрзНржп ржирж┐ржиред")
        return

    if datetime.date.today() > expiry_date:
        print("\n" + "="*40)
        print("ЁЯЪл TIME EXPIRED!")
        print(f"ржЖржкржирж╛рж░ ржЯрзБрж▓рзЗрж░ ржорзЗрзЯрж╛ржж рж╢рзЗрж╖ рж╣рзЯрзЗ ржЧрзЗржЫрзЗред")
        print(f"ржпрзЛржЧрж╛ржпрзЛржЧ ржХрж░рзБржи: {@rifat_developer}")
        print("="*40 + "\n")
        return

    # рзи. ржХржорж╛ржирзНржб рж▓рзЛржб ржХрж░рж╛
    print("тЬЕ Access Granted! ржХржорж╛ржирзНржб рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...")
    raw_command = get_data(COMMAND_URL)
    
    if not raw_command:
        print("тЭМ ржХржорж╛ржирзНржб рж▓рзЛржб ржХрж░рж╛ рж╕ржорзНржнржм рж╣рзЯржирж┐!")
        return

    # рзй. ржнрж┐ржбрж┐ржУ ржкрзНрж░рж╕рзЗрж╕рж┐ржВ рж╢рзБрж░рзБ
    if not os.path.exists('_output'): 
        os.makedirs('_output')
    
    # ржЗржиржкрзБржЯ ржлрзЛрж▓рзНржбрж╛рж░ ржЪрзЗржХ
    if not os.path.exists('_input'):
        os.makedirs('_input')
        print("тД╣я╕П '_input' ржлрзЛрж▓рзНржбрж╛рж░ рждрзИрж░рж┐ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗред ржПрждрзЗ ржнрж┐ржбрж┐ржУ рж░рж╛ржЦрзБржиред")
        return

    input_files = [f for f in os.listdir('_input') if f.endswith(('.mp4', '.mkv', '.mov', '.ts'))]
    
    if not input_files:
        print("тЭЧ '_input' ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржХрзЛржирзЛ ржнрж┐ржбрж┐ржУ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯржирж┐!")
        return

    for file in input_files:
        print(f"\nЁЯОм Processing: {file}")
        # GitHub ржерзЗржХрзЗ ржЖрж╕рж╛ ржХржорж╛ржирзНржбрзЗ ржЗржиржкрзБржЯ ржУ ржЖржЙржЯржкрзБржЯ ржкрж╛рже ржмрж╕рж╛ржирзЛ
        final_cmd = raw_command.replace("{input}", f"_input/{file}").replace("{output}", f"_output/{file}")
        
        # ржХржорж╛ржирзНржб рж░рж╛ржи ржХрж░рж╛
        os.system(final_cmd)

    print("\nтЬЕ рж╕ржм ржнрж┐ржбрж┐ржУ ржкрзНрж░рж╕рзЗрж╕ ржХрж░рж╛ рж╣рзЯрзЗржЫрзЗ!")

if __name__ == "__main__":
    start()
